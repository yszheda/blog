
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Galoisplusplus</title>
  <meta name="author" content="Galoisplusplus">

  
  <meta name="description" content="跟风来写个年度十大，回想起来2014年虽然听了一些渣演和车祸，但总的来说还是听得蛮爽的。
这个年度十大主要还是根据个人口味以及独特性来排的：有些演奏虽然完成度很高（例如三浦文彰），但是中规中矩，缺乏对音乐的思考（个人觉得三浦文彰那场在对音乐的处理上远不及钢伴Itamar Golan），所以没能入选 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://yszheda.github.io/blog/posts/6">
  <link href="/blog/favicon.png" rel="icon">
  <link href="/blog/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/blog/atom.xml" rel="alternate" title="Galoisplusplus" type="application/atom+xml">
  <script src="/blog/javascripts/modernizr-2.0.js"></script>
  <!--
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  -->
  <script src="//libs.baidu.com/jquery/1.7.2/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/blog/javascripts/octopress.js" type="text/javascript"></script>
  
<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<!--
<link href="http://fonts.googleapis.com/css?family=Crimson+Text:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
-->

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/blog/">Galoisplusplus</a></h1>
  
    <h2>A fan of science, technology and Classical music.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/blog/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:yszheda.github.io/blog" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/blog/">Blog</a></li>
  <li><a href="/blog/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2015/01/01/my-top-ten-concerts-in-2014/">我的2014年度十大现场音乐会</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-01-01T03:55:00+08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>跟风来写个年度十大，回想起来2014年虽然听了一些渣演和车祸，但总的来说还是听得蛮爽的。
这个年度十大主要还是根据个人口味以及独特性来排的：有些演奏虽然完成度很高（例如三浦文彰），但是中规中矩，缺乏对音乐的思考（个人觉得三浦文彰那场在对音乐的处理上远不及钢伴Itamar Golan），所以没能入选；相反，有些演奏虽然与本渣的口味大相异趣（例如波哥），但是对作品的诠释有自己一套独立的体系和逻辑，即使他这一套本渣尚未能理解，但还是赞赏这样的大师。当然了，像哈丁带LSO那种车祸就完全不用考虑了，如果评个年度最坑的三个半的话，DH倒是可以独占鳌头滴XDD</p>

<h2>No.10</h2>

<p>并列两场：</p>

<h3>南北印度古典音乐</h3>

<ul>
<li>地点：NTCH</li>
<li>曲目：无（即兴演奏）</li>
<li>演奏家：

<ul>
<li>竹笛：Shashank Subramanyam</li>
<li>Mridang：Parupalli Phalgun</li>
<li>西塔琴：Shujaat Khan</li>
<li>Tabula：Abniman Phalgun</li>
</ul>
</li>
</ul>


<p>如果不是为了凑TIFA套票，本渣也许不会想到去听阿三哥们的古典音乐。尽管之前通过梅爵爷了解过西塔琴大师拉维香卡——谁让Menuhin也是Ravi Shankar粉还一起录过唱片呢XDD（有趣的是，阿三们倒认为小提琴是本土乐器，源于罗波那（ravana）时期的ravanastron）——但听完这场仍大涨姿势，把它列入今年个人十大、与其他西方古典音乐会并排也是为了凸显它对本渣的独特意义。</p>

<p>印度古典音乐主要有南北之分：南印度的称为Carnatic，主要源于印度教寺庙音乐；北印度的称为Hindustani，虽然可追溯至吠陀时期，但主要是受阿拉伯音乐、特别是莫卧儿帝国的宫廷音乐的影响，属于阿三+波斯的混合物（这次演奏乐器之一的Tabula，其名称据说就源于阿拉伯语）。
这场音乐会全是即兴演奏，既有南印度的竹笛+Mridang鼓，也有北印度的西塔琴+塔布拉鼓（Tabula这词据说就源于阿拉伯语），都是主奏旋律乐器+伴奏打击乐器的组合。
上半场一开始是南印度组合单独演奏，接下来轮到北印度组合演奏时，Mridang鼓的演奏者也被邀请来伴奏，由于南北打击乐器伴奏风格不同，一开始他一直不知所措地打酱油orz&hellip;
下半场南北乐派的四位大叔一起席地而坐，同台献技。伴随着时不时插入的“<del>雅蠛蝶</del>Kya baat hai（大意相当于bravo）”和八拍子的击掌，大叔们已然玩high了，连向来作为伴奏乐器的两种鼓也反串成了主角&hellip;</p>

<h3>梅竹交响「胡桃里的宇宙」</h3>

<ul>
<li>地点：NTHU大礼堂</li>
<li>曲目：

<ul>
<li>上：

<ul>
<li>Graupner双小提琴协奏曲GWV334</li>
<li>Marquez的Danzon组曲第二号</li>
<li>维瓦尔第第八号双小提琴协奏曲RV522</li>
</ul>
</li>
<li>下：

<ul>
<li>老柴胡桃夹子组曲</li>
<li>辛德勒名单</li>
<li>霍尔斯特《行星组曲》之《木星》</li>
</ul>
</li>
<li>encore：拉德斯基进行曲</li>
</ul>
</li>
<li>指挥：叶永泉老师+郑乔文老师</li>
</ul>


<p>不消说，一支由两校学生组成的乐团在水平上是无法与专业乐团相比的，但本渣还是把它排上了年度十大，因为本渣在二提里面也打了个酱油，而且演出效果本渣觉得基本不留遗憾。此前本渣曾缺席了一个学期的团练，但暑练时看到要演本渣大爱的《行星组曲》时果断归队了———再者两校合演的机会实在难得，尤其梅竹赛一直停摆（不过即使梅竹赛照常办，对本渣个人来说其意义也比不上梅竹交响的合演）——暑练后由于找工作耽误了几次团练，回来后本渣只能混二提了。经过一个学期的排练，本渣总算把落下的东西赶上了，叶永泉老师和郑乔文老师调教乐团时对音乐的处理让本渣受益匪浅。我想如果乐团能把两位老师的一些建议做到位，演出的效果还可以更好：例如上半场一开始，叶老师就悄悄跟我们说不要赶，要慢一些，结果大家还是比较猴急，Danzon后边的速度实在是坑死管乐。</p>

<h2>No.9</h2>

<h3>Pogorelich独奏会</h3>

<ul>
<li>地点：馄饨皮</li>
<li>曲目：

<ul>
<li>上：

<ul>
<li>李斯特《但丁读后感》</li>
<li>舒曼C大调幻想曲Op.17</li>
</ul>
</li>
<li>下：

<ul>
<li>斯特拉文斯基《彼得鲁什卡》三乐章</li>
<li>勃拉姆斯帕格尼尼主题变奏曲</li>
</ul>
</li>
</ul>
</li>
</ul>


<p>波哥的独奏会还是很难得的，所以这次本渣还特意晚上请假去听。本场曲目上半场以「幻想」为主题，下半场则是改编自其他作品的技巧艰深的作品，其中本渣最喜欢的是舒曼的C幻，之前听波哥弹的舒曼交练也颇喜欢，想来本场的舒曼还是挺有盼头的，万万没想到波哥的上半场完全毁三观&hellip;&hellip;
当时下班走得晚，到馄饨皮时挺迟的，没看到音乐会前还在练琴的波哥。只见演出开始后，他拿着两本谱子徐徐走上台，向四方观众鞠完躬，把一本谱随意丢在地上，就此开始。尽管之前就听说波哥会把但丁奏鸣曲拖慢一倍，也听过他在录音中夸张的强弱对比，但这次现场听还是接受不能。舒曼C幻也延续了前面李斯特的诡诞，在第一乐章放慢之后，第二乐章突然比正常速度更快，完全理解不能&hellip;&hellip;最不能忍的是波哥故意把旋律弹散，无缘无故加进来许多延长和休止——甚至会停下来翻谱orz——简直是在治疗脑补旋律的强迫症&hellip;&hellip;
相较之下，下半场波哥的演绎让人容易接受多了，之前有些诡异的地方用到彼得鲁什卡第二乐章中反而增色不少，勃拉姆斯那首回敬李斯特的炫技之作波哥也展示了他宝刀未老的功力。</p>

<h3>NSO「英伦盛宴」</h3>

<ul>
<li>地点：NTCH</li>
<li>曲目：

<ul>
<li>上：

<ul>
<li>[首演] 李子声的作品《无II》</li>
<li>布里顿两首安魂曲之一的《交响安魂曲》Op.20</li>
</ul>
</li>
<li>下：沃尔顿的《伯沙撒王的宴会》</li>
</ul>
</li>
<li>指挥：吕绍嘉</li>
<li>男中音：Bo Skovhus</li>
</ul>


<p>个人感觉NSO在布里顿诞辰100周年过去一年之后才办这场音乐会有点对这位腐国作曲家怠慢了，不过这场曲目确实不太好演，需要更长的排练时间还是可以理解的。
第一首原本安排的是赵菁文的《黏土的寓言》首演，后来跳票了，改为首演本渣隔壁学校的音乐所所长李子声的作品《无II》。这部作品的副标题是《水》（《无I》的副标题是《山》），据说是受了频谱学派的启发，本渣表示太高端了，听得「晕过水蚊」&hellip;&hellip;
下半场沃尔顿的大部头是亮点，这部作品由于乐团和合唱团编制很大，演得并不多，所以这次能听到现场演奏实属难得。吕绍嘉和NSO将这部作品搬上舞台勇气可嘉，最后吕绍嘉也确实hold住了这大部头，男中音Skovhus的表现不俗。但这种夹杂器乐和声乐的作品对乐团、独唱和合唱团的要求都不低，想要多方面出彩很难，个人感觉这一场台湾爱乐合唱团也只是勉强没车祸而已。</p>

<p>PS.据说2015年跨年音乐会吕绍嘉又要挑战另一部大部头——勋伯格的《古雷之歌》&hellip;&hellip;</p>

<h2>No.8</h2>

<h3>Schiff独奏会</h3>

<ul>
<li>地点：新竹文化局演艺厅</li>
<li>曲目：全场的贝多芬晚期作品：

<ul>
<li>六首小品，Op.126</li>
<li>钢奏32号</li>
<li>迪亚贝利变奏曲</li>
</ul>
</li>
</ul>


<p>席夫弹完迪亚贝利后余兴未尽，一上来就弹了哥德堡的aria。
第二首弹了月光奏鸣曲，原本以为他只弹第一乐章，结果居然弹了全曲！现场观众越发兴奋了！
接下来弹了D899的第二首，谢幕后掌声不绝，于是他又弹了D899第三首。
第五首弹了他拿手的巴赫作品，意大利协奏曲中的一个乐章。
之后现场观众仍不愿离去，在媳妇一再谢幕后，台上通往后台的大门首次关上，本渣以为结束了便离去了——去pk了偶会乱说么&hellip;后来跟一位社团同学交流心得，他告诉我，媳妇最后还出来弹了肖邦的练习曲Op.10第三首，以此作为与观众的告别！虽说错过了最后一首，但加演五首也是本渣平生所遇到的最高记录了。</p>

<h3>首届魔都巴洛克音乐节之Purcell《狄朵与埃涅阿斯》</h3>

<ul>
<li>地点：上交小厅</li>
<li>演奏者：David Stern指挥烈火歌剧院</li>
</ul>


<p>没想到本渣第一次听歌剧竟然是古乐，还是普赛尔的这部引领腐国乐坛风骚的大作（直到布里顿《Peter Grimes》的出现）。不过狄朵实在演得过于滥情了，普赛尔把一个浪女子洗白成高冷女王，没想到这么被演员给洗黑了&hellip;&hellip;另外，小厅音效好，真是什么动静都听得特别清楚，Dido和Belinda的高跟一直在光滑的地上摩擦摩擦酱紫真心好吗&hellip;&hellip;简直是欺负乐团人少古乐器不洪亮啊&hellip;&hellip;第一幕时感觉乐团的音准有点问题，他们中间停下几次调音，不清楚是否是乐器跑音了&hellip;&hellip;这次Aeneas和三女巫倒是挺赞的，合唱团据说都是上音的学生，表现得也不错。虽然这次是音乐会版的歌剧，但并不缺乏戏剧表演，例如第二幕的雷声，还有第三幕开头，逗逼水手直接拿着酒瓶道具从台下一直蹦跶到台上了，还是蛮入戏的XDD</p>

<h2>No.7</h2>

<h3>Guttman独奏会</h3>

<ul>
<li>地点：NTCH</li>
<li>曲目：巴赫大无1、4、5</li>
</ul>


<p>这位大提琴家想必不用介绍了——老罗的学生、小提琴家卡岗的夫人、还有小薇（Elisso Virsaladze/Wirssaladze，为了和她奶奶Anastasia区分，本渣姑且叫「小薇」好了，谁叫台湾给她祖孙俩的姓翻成「薇莎拉兹」呢XDD）的闺蜜&hellip;&hellip;
可惜的是古特曼状态不佳，在拉第五组曲的库朗舞曲时出现了一个明显的错音之后，老太太似乎受了较大的影响，导致后面的萨拉班德和嘉禾舞曲也有一些小问题。但抛开错音不谈，老太太呈现的音乐是一流的，组曲各个部分的风格鲜明，音色多样，这点倒与小薇很像。我也很好奇她那种非主流的持弓是怎么办到的，有一次特意模仿这种持弓方式试拉了一段巴赫小无和一段柴小协，感觉也没有想象中那么难控制，而且还比较省力呢，跳弓毫无鸭梨啊，只是弓根那一段就废了，不知道如何做幅度较大的力度变化。</p>

<p>PS.姑奶奶明年还来馄饨皮，曲目也是大无，非常期待——要是小薇也来我朝演奏就好了～</p>

<h2>No.6</h2>

<h3>Angela Hewitt独奏会</h3>

<ul>
<li>地点：NTCH</li>
<li>曲目：

<ul>
<li>上：

<ul>
<li>BWV808</li>
<li>贝31钢奏Op.110</li>
</ul>
</li>
<li>下：

<ul>
<li>BWV903</li>
<li>李斯特钢奏</li>
</ul>
</li>
<li>encore：理查斯特劳斯的Morgen，算是Hewitt在“理查斯特劳斯年”对作曲家的纪念吧~</li>
</ul>
</li>
</ul>


<p>秀姨赶脚现在很少来内地，这次碰上她的独奏会本渣就果断买票去听了。这一场大部分曲目其实演奏得一般般，尤其Op.110和李B，但903绝对让本渣值回票价，详情请见博文：
<a href="http://galoisplusplus.coding.me/blog/2014/03/02/angela-hewitt-piano-recital/">Angela Hewitt Piano Recital</a></p>

<p>PS.秀姨原本今年要来魔都演一场的，后来取消了，还好本渣之前赶上了一场XDD</p>

<h2>No.5</h2>

<h3>ODP</h3>

<ul>
<li>地点：馄饨皮</li>
<li>曲目：全场R.Strauss作品

<ul>
<li>上：

<ul>
<li>《查拉图斯特拉如是说》</li>
</ul>
</li>
<li>下：

<ul>
<li>滑稽曲TrV 145</li>
<li>《玫瑰骑士》组曲</li>
</ul>
</li>
</ul>
</li>
</ul>


<p>本渣实在大爱这支法国团，尽管这次小雅尔维的「主菜」并不给力，详情请见博文：
<a href="http://galoisplusplus.coding.me/blog/2014/11/02/the-odp-concert/">the ODP Concert</a></p>

<h2>No.4</h2>

<p>还是并列两场好了～</p>

<h3>Poulet独奏会</h3>

<ul>
<li>地点：NCTU演艺厅</li>
<li>曲目：

<ul>
<li>上：

<ul>
<li>普朗克《小提琴奏鸣曲》</li>
<li>贝多芬《第六小提琴奏鸣曲》</li>
<li>拉赫《帕格尼尼狂想曲》第十八变奏</li>
</ul>
</li>
<li>下：

<ul>
<li>普罗《双小提琴奏鸣曲》</li>
<li>莫什科夫斯基《为双小提琴和钢琴而作的组曲》</li>
</ul>
</li>
<li>encore：老肖的五首双小提琴与钢琴小品</li>
</ul>
</li>
<li>钢伴是川岛余理，下半场与Poulet共同演奏双小提琴作品的是他的学生苏显达。</li>
</ul>


<p>巧的很，刚听完Capucon和BFO合演格拉小协不久后就遇上他的老师Gerard Poulet的演奏会。之前有人在围脖上说帕格尼尼小提琴比赛培养的是技术匠不是大师，还说历届大奖得主除了阿卡多外都无大成就，本渣觉得普雷这位帕赛冠军就是个很好的反例。话说Poulet和卡普松的台风简直是同一件模子刻出来的，各种在台上“跳舞”啊有木有&hellip;这次坐前排的表示Poulet演奏时还经常舔嘴，卡普松那次坐得太后了没发现&hellip;orz&hellip;</p>

<h3>郑京和独奏会</h3>

<ul>
<li>地点：东艺</li>
<li>曲目：

<ul>
<li>上：

<ul>
<li>莫扎特第27号小奏K379</li>
<li>普罗第1号小奏</li>
</ul>
</li>
<li>下：

<ul>
<li>巴赫恰空</li>
<li>弗朗克小奏</li>
</ul>
</li>
</ul>
</li>
<li>钢伴：Kevin Kenner</li>
</ul>


<p>听完之后简直对郑阿姨路人转粉，详情请见博文：
<a href="http://galoisplusplus.coding.me/blog/2014/10/19/Kyung-Wha-Chung-violin-recital/">Kyung Wha Chung Violin Recital</a></p>

<h2>No.3</h2>

<h3>Borealis大师班及演奏会</h3>

<ul>
<li>地点：NTHU合勤演艺厅</li>
<li>曲目：

<ul>
<li>贝多芬op18-3</li>
<li>德沃夏克“美国”</li>
</ul>
</li>
</ul>


<p>大师班上，社团同学组成的四重奏演奏了“美国”的第一乐章，感觉他们的演奏其实没什么硬伤了，但Borealis四重奏的四位大师们还是给了很多建议，引导他们怎么把曲子玩「乱」（大提琴家彭波先生语）XDDD
之后他们献演时也演了“美国”全曲，简直完爆本渣那四位同学，一提Patricia Shih的表现尤其抢眼（有一次苗头想cosplay她那晚的演奏但终究是没能成功XD）。</p>

<h2>No.2</h2>

<h3>BFO</h3>

<ul>
<li>地点：NTCH</li>
<li>曲目：

<ul>
<li>上：

<ul>
<li>鲍罗丁“鞑靼人之舞”</li>
<li>格拉祖诺夫小协</li>
<li>encore：格鲁克《旋律》</li>
</ul>
</li>
<li>下：

<ul>
<li>贝七</li>
<li>encore：巴托克两首罗马尼亚舞曲《Romanian Garden Gate》和《Little One》</li>
</ul>
</li>
</ul>
</li>
<li>指挥：Ivan Fischer</li>
<li>小提琴独奏：Capucon</li>
</ul>


<p>详情请见博文：
<a href="http://galoisplusplus.coding.me/blog/2014/03/15/the-bfo-concert/">the BFO Concert</a></p>

<h2>No.1</h2>

<h3>Elisso Virsaladze独奏会</h3>

<ul>
<li>地点：NTCH</li>
<li>曲目：

<ul>
<li>上：

<ul>
<li>K264</li>
<li>勃拉姆斯第一钢奏</li>
</ul>
</li>
<li>下：

<ul>
<li>海顿f小调行板与变奏曲</li>
<li>舒曼交响练习曲</li>
</ul>
</li>
<li>encore：

<ul>
<li>（未知）</li>
<li>李斯特改编舒曼的《献辞》</li>
<li>肖邦降E大调华丽大圆舞曲</li>
</ul>
</li>
</ul>
</li>
</ul>


<p>指挥大师Celibidache曾说过，他所得到的最高盛誉是指挥完某场音乐会后一位乐迷所说的「That&rsquo;s it」。2014年所听的音乐会中让本渣只能用「That&rsquo;s it」来形容的恐怕就是小薇的这场独奏了。听完这场，再去评价小薇如何诠释这套精心挑选的「变奏」主题曲目，或是分析这位老涅高徒是否集毛派三大家之大成已属多余，小薇的演奏确实是弹到本渣心里去了。</p>

<p>PS.谈到这位在我朝不太有名的钢琴家本渣总不免想多碎碎念介绍一会～</p>

<p>艾丽索.维萨拉德兹（Elisso Virsaladze，她的姓有时候也写成Wirssaladze，台译「薇莎拉兹」，为了跟其奶奶Anastasia Virsaladze区分，本渣姑且称之为「小薇」吧XD）出生于格鲁吉亚首都第比利斯，早年跟随奶奶老薇（Anastasia Virsaladze，Anna Essipova学生，Essipova为著名钢琴教父Leschetizky的学生与妻子，老薇也是一代名师，其学生除了小薇还有Bashkirov等）学习。后来进入莫斯科音乐学院跟随四巨头之一的老涅高兹（Heinrich Neuhaus）学习。老薇与三巨头关系不错（伊贡诺夫在二战时还在老薇家住了一年），而老涅高徒的小薇也与其他巨头有交流：据说她也曾得到戈登维瑟的指导，也曾当过伊贡诺夫学生奥伯林的课程助教。老涅逝世后小薇想拜吉列尔斯为师未果（据说剃须刀跟她说不需要学习了），最后跟了老涅的助教扎克（包揽了第三届肖赛冠军和玛祖卡奖的大神，阿方纳西夫也是其学生）。小薇在第二届柴赛中获得第三名（当年的冠军为阿什肯纳齐与奥格东），在舒曼国际钢琴与声乐比赛中更是力拔头筹。现在小薇也在莫斯科音乐学院任教，其著名学生包括Berezovsky、Volodin等。</p>

<p>小薇的录音包括舒曼、贝多芬、肖邦、李斯特、舒伯特、老柴、老肖、普罗和俄派钢琴家少碰的莫扎特等，绝大多数录音为Live Classics厂牌的现场录音。独奏录音目前有14张（顺道一提，本渣听的那场音乐会的上半场曲目K264和勃一钢奏都留有录音），这其中尤以舒曼诠释最为人称道。里赫特曾如此称赞她：「Elisso is an artist of highest caliber, perhaps the most outstanding woman pianist of our time. She is a deeply sincere, serious and extremely modest musician. I am impressed by her in every way. Could you imagine a more beautiful Schumann than the one played tonight by Elisso? Since Neuhaus I haven&rsquo;t heard such a Schumann performance.」（本渣印象中，最后这句话的梗出自里秃的回忆，有一次老涅——被里秃形容为「这位可怜的人」——心血来潮开了一场舒曼专场，结果上半场「演奏得像头猪」&hellip;下半场出现了奇迹，此后就是他所听过的最佳的舒曼&hellip;）</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2014/11/18/touchable-tableviewcell-in-cocos2d-x/">为cocos2d-x的TableViewCell控件添加点击及长按支持</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-11-18T23:23:00+08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>再次来聊一聊cocos2d-x的<code>TableView</code>。之前之所以用继承<code>TableView</code>的方式实现2D的<code>GridView</code>是因为用到<code>TableView</code>点击事件的地方涉及到全局数据的复杂处理，这块处理放到<code>TableViewDelegate</code>类的<code>tableCellTouched</code>比较合理。但这个函数在cell被点击时都会被调用，而实际游戏里一个cell往往只有部分UI才能被点击（所以当点击事件只与这个cell的数据相关时，直接把点击事件处理放到cell内部实现才是王道），故而我们需要对cell的点击区域做进一步的限制。为此，我封装了一个<code>TableViewCell</code>的子类来实现这一功能：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>TouchableTableViewCell::TouchableTableViewCell():
</span><span class='line'>    isValidTouched_(false),
</span><span class='line'>    touchableNode_(nullptr)
</span><span class='line'>{}
</span><span class='line'>
</span><span class='line'>TouchableTableViewCell::~TouchableTableViewCell()
</span><span class='line'>{}
</span><span class='line'>
</span><span class='line'>bool TouchableTableViewCell::init()
</span><span class='line'>{
</span><span class='line'>    if (!TableViewCell::init()) {
</span><span class='line'>        return false;
</span><span class='line'>    }
</span><span class='line'>    return true;
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>void TouchableTableViewCell::initTouchListener()
</span><span class='line'>{
</span><span class='line'>    auto touchListener = EventListenerTouchOneByOne::create();
</span><span class='line'>    CC_SAFE_RETAIN(touchListener);
</span><span class='line'>    Rect validTouchedRect;
</span><span class='line'>    validTouchedRect.size = touchableNode_-&gt;getContentSize();
</span><span class='line'>    touchListener-&gt;onTouchBegan = [=] (cocos2d::Touch* touch, cocos2d::Event* event) {
</span><span class='line'>        if (touchableNode_ == nullptr) {
</span><span class='line'>            return false;
</span><span class='line'>        }
</span><span class='line'>        auto touchLocation = touch-&gt;getLocation();
</span><span class='line'>        auto localLocation = touchableNode_-&gt;convertToNodeSpace(touchLocation);
</span><span class='line'>        if (validTouchedRect.containsPoint(localLocation)) {
</span><span class='line'>            isValidTouched_ = true;
</span><span class='line'>            return true;
</span><span class='line'>        } else {
</span><span class='line'>            isValidTouched_ = false;
</span><span class='line'>            return false;
</span><span class='line'>        }
</span><span class='line'>    };
</span><span class='line'>    touchListener-&gt;onTouchMoved = [=] (cocos2d::Touch* touch, cocos2d::Event* event) {
</span><span class='line'>        auto touchLocation = touch-&gt;getLocation();
</span><span class='line'>        auto localLocation = touchableNode_-&gt;convertToNodeSpace(touchLocation);
</span><span class='line'>        if (validTouchedRect.containsPoint(localLocation)) {
</span><span class='line'>            isValidTouched_ = true;
</span><span class='line'>        } else {
</span><span class='line'>            isValidTouched_ = false;
</span><span class='line'>        }
</span><span class='line'>    };
</span><span class='line'>    touchListener-&gt;onTouchEnded = touchListener-&gt;onTouchMoved;
</span><span class='line'>    touchListener-&gt;onTouchCancelled = touchListener-&gt;onTouchEnded;
</span><span class='line'>    _eventDispatcher-&gt;addEventListenerWithSceneGraphPriority(touchListener, this);
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>void TouchableTableViewCell::setTouchableNode(cocos2d::Node* touchableNode)
</span><span class='line'>{
</span><span class='line'>    touchableNode_ = touchableNode;
</span><span class='line'>    initTouchListener();
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>使用时只需让实际的<code>TableViewCell</code>类继承<code>TouchableTableViewCell</code>，在<code>tableCellTouched</code>函数中判断<code>isValidTouched_</code>即可。</p>

<p>另外，有时候我们需要让<code>TableViewCell</code>响应长按事件，我在之前的<code>TouchableTableViewCell</code>类上又做了一层封装，主要使用调度器来实现长按：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>const std::string LongTouchableTableViewCell::SCHEDULE_KEY = "LONG_TOUCHABLE_TABLE_VIEW_CELL";
</span><span class='line'>const float LongTouchableTableViewCell::LONG_TOUCH_INTERVAL = 0.2f;
</span><span class='line'>
</span><span class='line'>LongTouchableTableViewCell::LongTouchableTableViewCell():
</span><span class='line'>    TouchableTableViewCell(),
</span><span class='line'>    isTouchHold_(false),
</span><span class='line'>    isLongTouched_(false),
</span><span class='line'>    longTouchedCallback_(nullptr)
</span><span class='line'>{}
</span><span class='line'>
</span><span class='line'>LongTouchableTableViewCell::~LongTouchableTableViewCell()
</span><span class='line'>{}
</span><span class='line'>
</span><span class='line'>bool LongTouchableTableViewCell::init()
</span><span class='line'>{
</span><span class='line'>    if (!TouchableTableViewCell::init()) {
</span><span class='line'>        return false;
</span><span class='line'>    }
</span><span class='line'>    return true;
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>void LongTouchableTableViewCell::initTouchListener()
</span><span class='line'>{
</span><span class='line'>    auto touchListener = EventListenerTouchOneByOne::create();
</span><span class='line'>    CC_SAFE_RETAIN(touchListener);
</span><span class='line'>    Rect validTouchedRect;
</span><span class='line'>    validTouchedRect.size = touchableNode_-&gt;getContentSize();
</span><span class='line'>    touchListener-&gt;onTouchBegan = [=] (cocos2d::Touch* touch, cocos2d::Event* event) {
</span><span class='line'>        if (touchableNode_ == nullptr) {
</span><span class='line'>            return false;
</span><span class='line'>        }
</span><span class='line'>        auto touchLocation = touch-&gt;getLocation();
</span><span class='line'>        auto localLocation = touchableNode_-&gt;convertToNodeSpace(touchLocation);
</span><span class='line'>        if (validTouchedRect.containsPoint(localLocation)) {
</span><span class='line'>            isValidTouched_ = true;
</span><span class='line'>            isTouchHold_ = true;
</span><span class='line'>            isLongTouched_ = false;
</span><span class='line'>            
</span><span class='line'>            Director::getInstance()-&gt;getScheduler()-&gt;schedule([=](float) {
</span><span class='line'>                if (isTouchHold_) {
</span><span class='line'>                    isLongTouched_ = true;
</span><span class='line'>                    if (longTouchedCallback_ != nullptr) {
</span><span class='line'>                        longTouchedCallback_();
</span><span class='line'>                    }
</span><span class='line'>                }
</span><span class='line'>                Director::getInstance()-&gt;getScheduler()-&gt;unschedule(SCHEDULE_KEY, this);
</span><span class='line'>            }, this, LONG_TOUCH_INTERVAL, 0, 0.0f, false, SCHEDULE_KEY);
</span><span class='line'>
</span><span class='line'>            return true;
</span><span class='line'>        } else {
</span><span class='line'>            isValidTouched_ = false;
</span><span class='line'>            isTouchHold_ = false;
</span><span class='line'>            isLongTouched_ = false;
</span><span class='line'>
</span><span class='line'>            return false;
</span><span class='line'>        }
</span><span class='line'>    };
</span><span class='line'>    touchListener-&gt;onTouchMoved = [=] (cocos2d::Touch* touch, cocos2d::Event* event) {
</span><span class='line'>        isTouchHold_ = false;
</span><span class='line'>        isLongTouched_ = false;
</span><span class='line'>
</span><span class='line'>        auto touchLocation = touch-&gt;getLocation();
</span><span class='line'>        auto localLocation = touchableNode_-&gt;convertToNodeSpace(touchLocation);
</span><span class='line'>        if (validTouchedRect.containsPoint(localLocation)) {
</span><span class='line'>            isValidTouched_ = true;
</span><span class='line'>        } else {
</span><span class='line'>            isValidTouched_ = false;
</span><span class='line'>        }
</span><span class='line'>    };
</span><span class='line'>    touchListener-&gt;onTouchEnded = [=] (cocos2d::Touch* touch, cocos2d::Event* event) {
</span><span class='line'>        isTouchHold_ = false;
</span><span class='line'>
</span><span class='line'>        auto touchLocation = touch-&gt;getLocation();
</span><span class='line'>        auto localLocation = touchableNode_-&gt;convertToNodeSpace(touchLocation);
</span><span class='line'>        if (validTouchedRect.containsPoint(localLocation)) {
</span><span class='line'>            isValidTouched_ = true;
</span><span class='line'>        } else {
</span><span class='line'>            isValidTouched_ = false;
</span><span class='line'>        }
</span><span class='line'>    };
</span><span class='line'>    touchListener-&gt;onTouchCancelled = touchListener-&gt;onTouchEnded;
</span><span class='line'>    _eventDispatcher-&gt;addEventListenerWithSceneGraphPriority(touchListener, this);
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>完整代码详见：
<a href="https://github.com/yszheda/cocos2d-x-TouchableTableViewCell">cocos2d-x-TouchableTableViewCell</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2014/11/02/the-odp-concert/">The ODP Concert</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-11-02T23:55:00+08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>之前在高卢国呆了半年，巴黎管弦（ODP）是本渣颇喜爱的一支团——当年第一场在巴黎听的音乐会就是ODP的贝四钢协+理查的英雄生涯，那场听完之后已然无法接受里尔国立的水准了&hellip;
这回ODP现任音乐总监“普京”小雅尔维率亲兵来上交新厅演两场，本渣有空的周日是理查专场，当晚还有帕帕诺带意大利圣切契利亚管弦在魔都大剧院的音乐会，两场撞车了，本渣思来想去，最后还是去听ODP：
一部分原因是冲着ODP演理查，本渣生平第一次现场听理查作品就是Blomstedt大师指挥ODP，水平极高，让本渣当时很受震撼，直至今日仍念念不忘，ODP这支法国团的表现完全不亚于与布隆斯泰特大师录过英雄生涯的德国老牌名团SKD；
另一部分原因是还从未现场看现任音乐总监“普京”的指挥，倒是前任总监“伏地魔”艾森巴赫大师的现场看了一些（不过钟神说Järvi比布隆斯泰特和伏地魔都不靠谱）。</p>

<p>上半场是大部头交响诗作品《查拉图斯特拉如是说》，照“普京”的说法是要先上正餐，后上甜点，可惜“普京”的正餐弄得倒像是前菜了&hellip;一开始的“日出“，管乐的渐强没做出来；接下来”来世之人“的弱奏倒是很到位；”死亡之歌“的赋格段落感觉二提出不太来，不过也可能是坐的位置的缘故（本渣的位置在一提二提后面，倒有点像之前呆学校乐团看指挥的位置）；”舞之歌“首席与oboe的圆舞曲破美，当年这位首席也solo了英雄生涯的”英雄伴侣“，确实是hold得住全场的靠谱首席，倒是木管少了些生气，要是有最后演《玫瑰骑士组曲》那种rubato就好了；末尾的”夜游者之歌“也还可以。
总的来说，一些该闹腾的地方不尽如人意，不闹腾的地方还不错：铜管差评，有些拍子不太对，力度处理也不细致，还在不闹腾的地方倒口水发出噪音XDD——不得不说上交新厅音效太好了；木管和小提状态一般；double bass、cello、viola、定音鼓小哥要给个赞。</p>

<p>没想到下半场的甜点才是今晚音乐会的重头戏。首先是理查早年的作品《滑稽曲（Trv145）》，今年恰好ODP的老管家伏地魔和郎总也演了此曲，个人觉得郎总对此曲的游戏式炫技把握得更好一些，或者说更逗逼一些XDD。《玫瑰骑士》组曲是今晚的神演，在“普京”棒下，ODP做出了非常棒的rubato：欧克斯男爵的圆舞曲主题那种有些笨手笨脚有些莽撞的感觉表现得很十分生动，作曲家借元帅夫人表达的怀旧情怀也引起了本渣的共鸣，让本渣回忆起在巴黎的种种美好时光，包括在Salle Pleyel看ODP的演出。随后加演的两首Brahms同样延续了《玫瑰骑士》组曲的rubato，把现场气氛推向了高潮。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2014/10/31/irregular-button-in-cocos2d-x-v3/">Cocos2d-x V3.x不规则按钮</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-10-31T23:23:00+08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>cocos2d-x的按钮默认是以长方形作为点击区域的，实际使用时这确实很蛋疼。之前有大牛研究了如何获取图片的透明度实现不规则点击区域的方法，例如：</p>

<ul>
<li><p><a href="http://www.cnblogs.com/Androider123/p/3795050.html">cocos2d-x开发笔记：获取Sprite上某一个点的透明度，制作不规则按钮</a></p></li>
<li><p><a href="http://zengrong.net/post/2104.htm">在 cocos2d-x 中获取纹理的像素值</a></p></li>
</ul>


<p>可惜在cocos2d-x v3.0以上的版本，他们的方法都失效了，因此本渣也不得不自行琢磨这一块的实现。</p>

<p>之前方法的核心在于：图片每个像素点的RGBA信息被保存在Image类中，这个底层类并不会随着图片Node的创建而留在内存中（否则其内存占用量可想而知）。然而，在create出一个Sprite后，可以在内存中拿到它的Frame，再用RenderTextue重画一次拿到原始的Image，这样就可以判断图片上任意点的像素了。如果某点像素的Alpha值为0，则说明它是透明的，点击在该点是无效的。</p>

<p>这种方法是所以会失效，是因为cocos2d-x v3.0的RenderTexture是异步渲染的，导致拿到的Image并不是最后渲染的结果。本渣用了一种简单粗暴的方法，用Image类的initWithImageFile()方法去初始化Image对象，这样就确保了对象的数据是正确的。但是这种方法会有文件IO，不宜频繁调用，因此我只在一开始时创建一次，用一个bool数组保存每个像素点是否透明度为0的信息。每次触发点击事件时，就根据这个数组的值来判断点击是否有效。我把这部分逻辑封装到<code>cocos2d::ui::Button</code>的子类<code>IrregularButton</code>中，具体代码详见：
<a href="https://github.com/yszheda/cocos2d-x-irregular-button">cocos2d-x-irregular-button</a></p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/blog/2014/10/31/irregular-button-in-cocos2d-x-v3/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2014/10/19/Kyung-Wha-Chung-violin-recital/">Kyung Wha Chung Violin Recital</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-10-19T23:45:00+08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>今晚去听了郑京和来魔都东艺的独奏会。据说郑京和是首次来沪，去年中国巡演时她去了京广深台，却偏偏漏掉了魔都这一大站。这次赶脚东艺也想努力营造一个好氛围，以前本渣是阔已带双肩包进场的，这次就被告知需要寄放。不过开演时还有一些人在找位置，一下就引起郑京和的不满，她环顾四周，一直等到大家都安静下来才开始，场面很是尴尬&hellip;&hellip;演奏第二首前也是如此，大师还直接竖食指示意安静&hellip;&hellip;尽管如此，小孩哭闹、咳嗽、东西掉落神马的还是时有发生&hellip;&hellip;倒是乐章之间乱鼓掌没有了——下半场的Franck小奏除外——也是醉了&hellip;&hellip;</p>

<p>今天大师虽然一开始带有情绪，但还是奉献了一场水平极高的演出。K379大师在各种细节上下足了功夫，连拨弦也有细腻的力度变化，让本渣十分震撼。普罗第一小奏大师为了凸显强弱对比，还用了弱音器。下半场是本渣最为期待的，第一首是偶最稀饭的巴赫恰空，第二首是弗朗克小奏，而本渣恰恰最推崇郑京和演奏的弗兰克和布鲁赫。郑京和这次的恰空出现了一些错音，但总体上瑕不掩瑜，细节上也有她自己一套处理：尽量采用了legato，因此用了一些和本渣谱上不同的弓法；一些分解和弦并没有保证时值一致，但却保证了清晰性。弗兰克小奏是大师拿手的曲目，据说当年她复出也是演奏过这首曲子，本渣也收藏了她和Lupu录的一版CD（Decca 4600062），这次听现场觉得大师功力不减当年，第二乐章刚结束便有些观众迫不及待地鼓起掌来orz&hellip;</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2014/09/22/the-great-violinists-reading-nodes/">Margaret Campbell《不朽的小提琴家》读书笔记</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-09-22T22:00:00+08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>我读的是台版翻译，笔记放到了个人wiki上。不得不说里面的小提琴流派图和各种历史相片真是太赞了，我把它们都扫描了一遍放到链接里~</p>

<object type="text/html" data="http://yszheda.github.io/wiki/the-great-violinists" style="width:100%; height:100%">
<p><a href="http://yszheda.github.io/wiki/the-great-violinists">Margaret Campbell《不朽的小提琴家》读书笔记</a></p>
</object>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2014/09/22/I-Grandi-Directtori-d-Orchestra-reading-nodes/">Enrico Stinchelli《不朽的指挥家》读书笔记</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-09-22T22:00:00+08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>我读的是台湾翻译的Enrico Stinchelli的著作《I Grandi Directtori d'Orchestra》，做了些摘抄在个人wiki上：</p>

<object type="text/html" data="http://yszheda.github.io/wiki/conductor-history" style="width:100%; height:100%">
<p><a href="http://yszheda.github.io/wiki/conductor-history">Enrico Stinchelli《不朽的指挥家》读书笔记</a></p>
</object>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2014/09/20/gridview-in-cocos2d-x/">cocos2d-x二维TableView/GridView的实现</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-09-20T23:23:00+08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>对于刚开始接触cocos2d-x的<code>TableView</code>的人来说，这个UI类看上去并非顾名思义的是个Table，而仅仅是个一维的List。
因为项目需要，我封装了一个<code>TableView</code>的子类来实现二维的功能。效果如下：</p>

<p><img src="/blog/images/GridViewDemo/gridview.gif"></p>

<p>具体代码详见：
<a href="https://github.com/yszheda/cocos2d-x-GridView">cocos2d-x-GridView</a></p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/blog/2014/09/20/gridview-in-cocos2d-x/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2014/09/02/bmfont-generator/">BMFont字体生成脚本</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-09-02T01:22:00+08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>最近我们游戏需要用到<code>BMFont</code>字体，但又没有好的免费工具给美术大大们生成字体所需要的图集和<code>fnt</code>文件。
好在本渣在网上找到了一份详尽的<code>fnt</code>格式<a href="http://www.angelcode.com/products/bmfont/doc/file_format.html">说明文档</a>，我们三位前端开发者都是用Mac，所以本渣就用自己熟悉的bash写了一个生成<code>BMFont</code>的脚本。
我们只需要让美术大大们出好字体里每个字符的图片png，将图片命名成字符的名字（例如数字0的图片需要命名成“0.png”），放到某个目录下，执行脚本，指定图片目录（也就是脚本里的<code>&lt;inputPath&gt;</code>）和<code>BMFont</code>字体的名字（也就是脚本里的<code>&lt;prefix&gt;</code>）就可以了。最后这个脚本会在图片目录下创建一个叫做<code>output</code>的目录，里面就有图集<code>&lt;prefix&gt;.png</code>和配置文件<code>&lt;prefix&gt;.fnt</code>。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
<span class='line-number'>153</span>
<span class='line-number'>154</span>
<span class='line-number'>155</span>
<span class='line-number'>156</span>
<span class='line-number'>157</span>
<span class='line-number'>158</span>
<span class='line-number'>159</span>
<span class='line-number'>160</span>
<span class='line-number'>161</span>
<span class='line-number'>162</span>
<span class='line-number'>163</span>
<span class='line-number'>164</span>
<span class='line-number'>165</span>
<span class='line-number'>166</span>
<span class='line-number'>167</span>
<span class='line-number'>168</span>
<span class='line-number'>169</span>
<span class='line-number'>170</span>
<span class='line-number'>171</span>
<span class='line-number'>172</span>
<span class='line-number'>173</span>
<span class='line-number'>174</span>
<span class='line-number'>175</span>
<span class='line-number'>176</span>
<span class='line-number'>177</span>
<span class='line-number'>178</span>
<span class='line-number'>179</span>
<span class='line-number'>180</span>
<span class='line-number'>181</span>
<span class='line-number'>182</span>
<span class='line-number'>183</span>
<span class='line-number'>184</span>
<span class='line-number'>185</span>
<span class='line-number'>186</span>
<span class='line-number'>187</span>
<span class='line-number'>188</span>
<span class='line-number'>189</span>
<span class='line-number'>190</span>
<span class='line-number'>191</span>
<span class='line-number'>192</span>
<span class='line-number'>193</span>
<span class='line-number'>194</span>
<span class='line-number'>195</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="c">#!/bin/bash</span>
</span><span class='line'><span class="c"># Generate BMFont fnt and atlas from the image files of each character.</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="o">[</span> <span class="nv">$1</span> <span class="o">==</span> <span class="s2">&quot;-h&quot;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span><span class='line'>    <span class="nb">echo</span> <span class="s2">&quot;Usage: &quot;</span>
</span><span class='line'>    <span class="nb">echo</span> <span class="s2">&quot;$(basename $0) &lt;inputPath&gt; &lt;prefix&gt;&quot;</span>
</span><span class='line'>    <span class="nb">echo</span> <span class="s2">&quot;generate png and fnt under &lt;inputPath&gt;/output&quot;</span>
</span><span class='line'>    <span class="nb">echo</span> <span class="s2">&quot;&lt;inputPath&gt;: path containing images&quot;</span>
</span><span class='line'>    <span class="nb">echo</span> <span class="s2">&quot;&lt;prefix&gt;: prefix of output file names&quot;</span>
</span><span class='line'>    <span class="nb">exit </span>0
</span><span class='line'><span class="k">fi</span>
</span><span class='line'>
</span><span class='line'><span class="nv">inputPath</span><span class="o">=</span><span class="nv">$1</span>
</span><span class='line'><span class="nv">prefix</span><span class="o">=</span><span class="nv">$2</span>
</span><span class='line'><span class="nv">outputPath</span><span class="o">=</span><span class="s2">&quot;./output&quot;</span>
</span><span class='line'><span class="k">if</span> <span class="o">[[</span> <span class="nv">$3</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span><span class='line'>    <span class="nv">outputPath</span> <span class="o">=</span> <span class="nv">$3</span>
</span><span class='line'><span class="k">fi</span>
</span><span class='line'>
</span><span class='line'><span class="nv">localPngFile</span><span class="o">=</span><span class="k">${</span><span class="nv">prefix</span><span class="k">}</span>.png
</span><span class='line'><span class="nv">pngFile</span><span class="o">=</span><span class="k">${</span><span class="nv">outputPath</span><span class="k">}</span>/<span class="k">${</span><span class="nv">localPngFile</span><span class="k">}</span>
</span><span class='line'><span class="nv">fntFile</span><span class="o">=</span><span class="k">${</span><span class="nv">outputPath</span><span class="k">}</span>/<span class="k">${</span><span class="nv">prefix</span><span class="k">}</span>.fnt
</span><span class='line'><span class="nv">pngFileList</span><span class="o">=(</span><span class="k">$(</span>ls <span class="k">${</span><span class="nv">inputPath</span><span class="k">}</span> <span class="p">|</span> grep png <span class="p">|</span> sort<span class="k">)</span><span class="o">)</span>
</span><span class='line'>
</span><span class='line'><span class="nv">charWidth</span><span class="o">=</span><span class="k">$(</span>ls <span class="k">${</span><span class="nv">inputPath</span><span class="k">}</span> <span class="p">|</span> grep png <span class="p">|</span> head -1 <span class="p">|</span> xargs file <span class="p">|</span> awk -F<span class="s1">&#39;,&#39;</span> <span class="s1">&#39;{print $2}&#39;</span><span class="p">|</span> awk <span class="s1">&#39;/x/{print $1}&#39;</span><span class="k">)</span>
</span><span class='line'><span class="nv">charHeight</span><span class="o">=</span><span class="k">$(</span>ls <span class="k">${</span><span class="nv">inputPath</span><span class="k">}</span> <span class="p">|</span> grep png <span class="p">|</span> head -1 <span class="p">|</span> xargs file <span class="p">|</span> awk -F<span class="s1">&#39;,&#39;</span> <span class="s1">&#39;{print $2}&#39;</span><span class="p">|</span> awk <span class="s1">&#39;/x/{print $3}&#39;</span><span class="k">)</span>
</span><span class='line'>
</span><span class='line'><span class="nv">imageNum</span><span class="o">=</span><span class="k">$(</span>find <span class="k">${</span><span class="nv">inputPath</span><span class="k">}</span> -d <span class="m">1</span> -name <span class="s2">&quot;*.png&quot;</span> <span class="p">|</span> wc -l<span class="k">)</span>
</span><span class='line'><span class="c"># remove leading whitespace</span>
</span><span class='line'><span class="nb">shopt</span> -s extglob
</span><span class='line'><span class="nv">imageNum</span><span class="o">=</span><span class="k">${</span><span class="nv">imageNum</span><span class="p">##*( )</span><span class="k">}</span>
</span><span class='line'><span class="nb">shopt</span> -u extglob
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>clean <span class="o">()</span>
</span><span class='line'><span class="o">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="o">[[</span> -d <span class="k">${</span><span class="nv">outputPath</span><span class="k">}</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span><span class='line'>        rm <span class="k">${</span><span class="nv">outputPath</span><span class="k">}</span>/*
</span><span class='line'>    <span class="k">else</span>
</span><span class='line'>        mkdir <span class="k">${</span><span class="nv">outputPath</span><span class="k">}</span>
</span><span class='line'>    <span class="k">fi</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>mergePngs <span class="o">()</span>
</span><span class='line'><span class="o">{</span>
</span><span class='line'>    <span class="k">if</span> ! <span class="nb">type </span>convert &gt; /dev/null<span class="p">;</span> <span class="k">then</span>
</span><span class='line'>        <span class="nb">echo</span> <span class="s2">&quot;You need to install [ImageMagic](http://www.imagemagick.org/).&quot;</span>
</span><span class='line'>    <span class="k">else</span>
</span><span class='line'>        <span class="c"># ATTENTION: if you are using BSD/Mac, use the following command:</span>
</span><span class='line'>        find <span class="k">${</span><span class="nv">inputPath</span><span class="k">}</span> -d <span class="m">1</span> -name <span class="s2">&quot;*.png&quot;</span> <span class="p">|</span> sort <span class="p">|</span> tr <span class="s1">&#39;\n&#39;</span> <span class="s1">&#39; &#39;</span> <span class="p">|</span> xargs -J % convert % +append <span class="k">${</span><span class="nv">pngFile</span><span class="k">}</span>
</span><span class='line'>        <span class="c"># ATTENTION: if you are using UNIX/GNU Linux, use the following command instead:</span>
</span><span class='line'>        <span class="c"># find ${inputPath} -d 1 -name &quot;*.png&quot; | sort | tr &#39;\n&#39; &#39; &#39; | xargs -I % convert % +append ${pngFile}</span>
</span><span class='line'>    <span class="k">fi</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="c">##################################################</span>
</span><span class='line'><span class="c"># Reference Document:</span>
</span><span class='line'><span class="c"># http://www.angelcode.com/products/bmfont/doc/file_format.html</span>
</span><span class='line'><span class="c">##################################################</span>
</span><span class='line'><span class="c"># info: This tag holds information on how the font was generated.</span>
</span><span class='line'><span class="c">##################################################</span>
</span><span class='line'><span class="c"># face    This is the name of the true type font.</span>
</span><span class='line'><span class="nv">face</span><span class="o">=</span><span class="s2">&quot;Arial&quot;</span>
</span><span class='line'><span class="c"># size    The size of the true type font.</span>
</span><span class='line'><span class="nv">size</span><span class="o">=</span>32
</span><span class='line'><span class="c"># bold    The font is bold.</span>
</span><span class='line'><span class="nv">bold</span><span class="o">=</span>0
</span><span class='line'><span class="c"># italic  The font is italic.</span>
</span><span class='line'><span class="nv">italic</span><span class="o">=</span>0
</span><span class='line'><span class="c"># charset The name of the OEM charset used (when not unicode).</span>
</span><span class='line'><span class="nv">charset</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
</span><span class='line'><span class="c"># unicode Set to 1 if it is the unicode charset.</span>
</span><span class='line'><span class="nv">unicode</span><span class="o">=</span>0
</span><span class='line'><span class="c"># stretchH    The font height stretch in percentage. 100% means no stretch.</span>
</span><span class='line'><span class="nv">stretchH</span><span class="o">=</span>100
</span><span class='line'><span class="c"># smooth  Set to 1 if smoothing was turned on.</span>
</span><span class='line'><span class="nv">smooth</span><span class="o">=</span>1
</span><span class='line'><span class="c"># aa  The supersampling level used. 1 means no supersampling was used.</span>
</span><span class='line'><span class="nv">aa</span><span class="o">=</span>1
</span><span class='line'><span class="c"># padding The padding for each character (up, right, down, left).</span>
</span><span class='line'><span class="nv">paddingUp</span><span class="o">=</span>0
</span><span class='line'><span class="nv">paddingRight</span><span class="o">=</span>0
</span><span class='line'><span class="nv">paddingDown</span><span class="o">=</span>0
</span><span class='line'><span class="nv">paddingLeft</span><span class="o">=</span>0
</span><span class='line'><span class="c"># spacing The spacing for each character (horizontal, vertical).</span>
</span><span class='line'><span class="nv">spacingH</span><span class="o">=</span>0
</span><span class='line'><span class="nv">spacingV</span><span class="o">=</span>0
</span><span class='line'><span class="c"># outline The outline thickness for the characters.</span>
</span><span class='line'><span class="nv">outline</span><span class="o">=</span>0
</span><span class='line'><span class="c">##################################################</span>
</span><span class='line'><span class="c"># common: This tag holds information common to all characters.</span>
</span><span class='line'><span class="c">##################################################</span>
</span><span class='line'><span class="c"># lineHeight  This is the distance in pixels between each line of text.</span>
</span><span class='line'><span class="nv">lineHeight</span><span class="o">=</span><span class="k">${</span><span class="nv">charHeight</span><span class="k">}</span>
</span><span class='line'><span class="c"># base    The number of pixels from the absolute top of the line to the base of the characters.</span>
</span><span class='line'><span class="nv">base</span><span class="o">=</span><span class="k">${</span><span class="nv">charHeight</span><span class="k">}</span>
</span><span class='line'><span class="c"># scaleW  The width of the texture, normally used to scale the x pos of the character image.</span>
</span><span class='line'><span class="nv">scaleW</span><span class="o">=</span>256
</span><span class='line'><span class="c"># scaleH  The height of the texture, normally used to scale the y pos of the character image.</span>
</span><span class='line'><span class="nv">scaleH</span><span class="o">=</span>256
</span><span class='line'><span class="c"># pages   The number of texture pages included in the font.</span>
</span><span class='line'><span class="nv">pages</span><span class="o">=</span>1
</span><span class='line'><span class="c"># packed  Set to 1 if the monochrome characters have been packed into each of the texture channels. In this case alphaChnl describes what is stored in each channel.</span>
</span><span class='line'><span class="nv">packed</span><span class="o">=</span>0
</span><span class='line'><span class="c"># alphaChnl   Set to 0 if the channel holds the glyph data, 1 if it holds the outline, 2 if it holds the glyph and the outline, 3 if its set to zero, and 4 if its set to one.</span>
</span><span class='line'><span class="nv">alphaChnl</span><span class="o">=</span>1
</span><span class='line'><span class="c"># redChnl Set to 0 if the channel holds the glyph data, 1 if it holds the outline, 2 if it holds the glyph and the outline, 3 if its set to zero, and 4 if its set to one.</span>
</span><span class='line'><span class="nv">redChnl</span><span class="o">=</span>0
</span><span class='line'><span class="c"># greenChnl   Set to 0 if the channel holds the glyph data, 1 if it holds the outline, 2 if it holds the glyph and the outline, 3 if its set to zero, and 4 if its set to one.</span>
</span><span class='line'><span class="nv">greenChnl</span><span class="o">=</span>0
</span><span class='line'><span class="c"># blueChnl    Set to 0 if the channel holds the glyph data, 1 if it holds the outline, 2 if it holds the glyph and the outline, 3 if its set to zero, and 4 if its set to one.</span>
</span><span class='line'><span class="nv">blueChnl</span><span class="o">=</span>0
</span><span class='line'><span class="c">##################################################</span>
</span><span class='line'><span class="c"># page: This tag gives the name of a texture file. There is one for each page in the font.</span>
</span><span class='line'><span class="c">##################################################</span>
</span><span class='line'><span class="c"># id  The page id.</span>
</span><span class='line'><span class="nv">id</span><span class="o">=</span>0
</span><span class='line'><span class="c"># file    The texture file name.</span>
</span><span class='line'><span class="nv">file</span><span class="o">=</span><span class="k">${</span><span class="nv">localPngFile</span><span class="k">}</span>
</span><span class='line'><span class="c">##################################################</span>
</span><span class='line'><span class="c"># char: This tag describes on character in the font. There is one for each included character in the font.</span>
</span><span class='line'><span class="c">##################################################</span>
</span><span class='line'><span class="c"># id  The character id.</span>
</span><span class='line'><span class="c"># x   The left position of the character image in the texture.</span>
</span><span class='line'><span class="c"># y   The top position of the character image in the texture.</span>
</span><span class='line'><span class="nv">y</span><span class="o">=</span>0
</span><span class='line'><span class="c"># width   The width of the character image in the texture.</span>
</span><span class='line'><span class="nv">width</span><span class="o">=</span><span class="k">${</span><span class="nv">charWidth</span><span class="k">}</span>
</span><span class='line'><span class="c"># height  The height of the character image in the texture.</span>
</span><span class='line'><span class="nv">height</span><span class="o">=</span><span class="k">${</span><span class="nv">charHeight</span><span class="k">}</span>
</span><span class='line'><span class="c"># xoffset How much the current position should be offset when copying the image from the texture to the screen.</span>
</span><span class='line'><span class="nv">xoffset</span><span class="o">=</span>0
</span><span class='line'><span class="c"># yoffset How much the current position should be offset when copying the image from the texture to the screen.</span>
</span><span class='line'><span class="nv">yoffset</span><span class="o">=</span>0
</span><span class='line'><span class="c"># xadvance    How much the current position should be advanced after drawing the character.</span>
</span><span class='line'><span class="nv">xadvance</span><span class="o">=</span><span class="k">${</span><span class="nv">charWidth</span><span class="k">}</span>
</span><span class='line'><span class="c"># page    The texture page where the character image is found.</span>
</span><span class='line'><span class="nv">page</span><span class="o">=</span>0
</span><span class='line'><span class="c"># chnl    The texture channel where the character image is found (1 = blue, 2 = green, 4 = red, 8 = alpha, 15 = all channels).</span>
</span><span class='line'><span class="nv">chnl</span><span class="o">=</span>15
</span><span class='line'><span class="c">##################################################</span>
</span><span class='line'><span class="c"># kerning: The kerning information is used to adjust the distance between certain characters, e.g. some characters should be placed closer to each other than others.</span>
</span><span class='line'><span class="c">##################################################</span>
</span><span class='line'><span class="c"># first   The first character id.</span>
</span><span class='line'><span class="c"># second  The second character id.</span>
</span><span class='line'><span class="c"># amount  How much the x position should be adjusted when drawing the second character immediately following the first.</span>
</span><span class='line'><span class="c">##################################################</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>writeInfo <span class="o">()</span>
</span><span class='line'><span class="o">{</span>
</span><span class='line'>    <span class="nb">echo</span> <span class="s2">&quot;info face=\&quot;${face}\&quot; size=${size} bold=${bold} italic=${italic} charset=\&quot;${charset}\&quot; unicode=${unicode} stretchH=${stretchH} smooth=${smooth} aa=${aa} padding=${paddingUp},${paddingRight},${paddingDown},${paddingLeft} spacing=${spacingH},${spacingV} outline=${outline}&quot;</span>
</span><span class='line'>    <span class="nb">echo</span> <span class="s2">&quot;info face=\&quot;${face}\&quot; size=${size} bold=${bold} italic=${italic} charset=\&quot;${charset}\&quot; unicode=${unicode} stretchH=${stretchH} smooth=${smooth} aa=${aa} padding=${paddingUp},${paddingRight},${paddingDown},${paddingLeft} spacing=${spacingH},${spacingV} outline=${outline}&quot;</span> &gt;&gt; <span class="k">${</span><span class="nv">fntFile</span><span class="k">}</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>writeCommon <span class="o">()</span>
</span><span class='line'><span class="o">{</span>
</span><span class='line'>    <span class="nb">echo</span> <span class="s2">&quot;common lineHeight=${lineHeight} base=${base} scaleW=${scaleW} scaleH=${scaleH} pages=${pages} packed=${packed} alphaChnl=${alphaChnl} redChnl=${redChnl} greenChnl=${greenChnl} blueChnl=${blueChnl}&quot;</span>
</span><span class='line'>    <span class="nb">echo</span> <span class="s2">&quot;common lineHeight=${lineHeight} base=${base} scaleW=${scaleW} scaleH=${scaleH} pages=${pages} packed=${packed} alphaChnl=${alphaChnl} redChnl=${redChnl} greenChnl=${greenChnl} blueChnl=${blueChnl}&quot;</span> &gt;&gt; <span class="k">${</span><span class="nv">fntFile</span><span class="k">}</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>writePage <span class="o">()</span>
</span><span class='line'><span class="o">{</span>
</span><span class='line'>    <span class="nb">echo</span> <span class="s2">&quot;page id=${id} file=\&quot;${file}\&quot;&quot;</span>
</span><span class='line'>    <span class="nb">echo</span> <span class="s2">&quot;page id=${id} file=\&quot;${file}\&quot;&quot;</span> &gt;&gt; <span class="k">${</span><span class="nv">fntFile</span><span class="k">}</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>writeChars <span class="o">()</span>
</span><span class='line'><span class="o">{</span>
</span><span class='line'>    <span class="nb">echo</span> <span class="s2">&quot;chars count=${imageNum}&quot;</span>
</span><span class='line'>    <span class="nb">echo</span> <span class="s2">&quot;chars count=${imageNum}&quot;</span> &gt;&gt; <span class="k">${</span><span class="nv">fntFile</span><span class="k">}</span>
</span><span class='line'>    <span class="nb">declare</span> -i <span class="nv">i</span><span class="o">=</span>0
</span><span class='line'>    <span class="k">for</span> file in <span class="s2">&quot;${pngFileList[@]}&quot;</span>
</span><span class='line'>    <span class="k">do</span>
</span><span class='line'>        <span class="nv">letter</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="k">${</span><span class="nv">file</span><span class="k">}</span> <span class="p">|</span> cut -d<span class="s1">&#39;.&#39;</span> -f <span class="m">1</span> <span class="p">|</span> tail -c 2<span class="k">)</span>
</span><span class='line'>        <span class="nv">id</span><span class="o">=</span><span class="k">$(</span><span class="nb">printf</span> <span class="s1">&#39;%d&#39;</span> <span class="s2">&quot;&#39;${letter}&quot;</span><span class="k">)</span>
</span><span class='line'>        <span class="nb">let</span> <span class="s2">&quot;x = charWidth * i&quot;</span>
</span><span class='line'>        <span class="nb">echo</span> <span class="s2">&quot;char id=${id} x=${x} y=${y} width=${width} height=${height} xoffset=${xoffset} yoffset=${yoffset} xadvance=${xadvance} page=${page} chnl=${chnl}&quot;</span>
</span><span class='line'>        <span class="nb">echo</span> <span class="s2">&quot;char id=${id} x=${x} y=${y} width=${width} height=${height} xoffset=${xoffset} yoffset=${yoffset} xadvance=${xadvance} page=${page} chnl=${chnl}&quot;</span> &gt;&gt; <span class="k">${</span><span class="nv">fntFile</span><span class="k">}</span>
</span><span class='line'>        <span class="nb">let</span> <span class="s2">&quot;i += 1&quot;</span>
</span><span class='line'>    <span class="k">done</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>clean
</span><span class='line'>mergePngs
</span><span class='line'>touch <span class="k">${</span><span class="nv">fntFile</span><span class="k">}</span>
</span><span class='line'>writeInfo
</span><span class='line'>writeCommon
</span><span class='line'>writePage
</span><span class='line'>writeChars
</span></code></pre></td></tr></table></div></figure>


<p>需要说明的是，本渣也只是出于工作需求去写这个脚本，并没有时间去开发一个完整的BMFont字体生成器，所以功能还是有局限的：</p>

<ul>
<li><p>目前只支持png，但这很容易拓展，我用的是<code>ImageMagic</code>来生成图集，<code>ImageMagic</code>可以处理很多图片格式。</p></li>
<li><p>目前图集只有一行字符，因为我们用到的BMFont里字符数不多，没有做多行的必要。</p></li>
<li><p>目前只支持每个字符图片大小一致的情况，这也是由我们美术大大出的图片资源决定的，暂时没有扩展的需求。</p></li>
<li><p>暂时没有kerning等字体设置。</p></li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2014/08/31/optimize-local-src-files-and-local-c-includes-in-android-dot-mk/">如何自动设好Android.mk的LOCAL_SRC_FILES和LOCAL_C_INCLUDES</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-08-31T15:30:00+08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>用cocos2d-x开发Android游戏时，需要在Android.mk文件中，为LOCAL_SRC_FILES变量指定要编译的源代码，以及为LOCAL_C_INCLUDES变量指定头文件。当项目文件越来越多时，这种手动修改很浪费时间。好在Android.mk其实就是一个makefile，我们可以借助makefile语法来自动完成这部分工作。</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/blog/2014/08/31/optimize-local-src-files-and-local-c-includes-in-android-dot-mk/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="7">&larr; Older</a>
    
    <a href="/blog/blog/archives">Blog Archives</a>
    
    <a class="next" href="5">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/blog/2019/04/07/macbeth-by-tang-shu-wing/">《麦克白》的布莱希特剧场实践</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2019/01/01/those-concerts-in-2018/">盘点2018年度的现场音乐会</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2018/05/22/cudaErrorCudartUnloading/">cudaErrorCudartUnloading问题排查及建议方案</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2018/01/01/those-concerts-in-2017/">盘点2017年度的现场音乐会</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2017/11/11/Jonas-Kaufmann-recital/">Jonas Kaufmann独奏会之艺术歌曲</a>
      </li>
    
  </ul>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
<!--
Copyright &copy; 2020 - Galoisplusplus -
-->
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  


</body>
</html>
